<!doctype html>

<html lang="en">
<head>
  <meta charset="utf-8">
  <link rel="stylesheet" href="test-page.css" />
    <title>Spell Check It!</title>
</head>

<body>
    <h1> MultiDict</h1>
    <p> Spell checking made easy<p>
    <p>
      <textarea id="one" rows="20" cols="30">broth It was a dark and stormy night... Haben sie zeit für brot?

kablam shizzle brot?</textarea>
    </p>
    <p> Known Bugs<br>
      - removing border from textarea misaligns backdrop/highlights
    </p>
    <p>
      <div class="suggestions-wrapper">
        <div class="suggestions">
          <div class="suggestion">trot</div>
          <div class="suggestion">brow</div>
          <div class="suggestion">broth</div>
          <div class="suggestion">rot</div>
          <div class="suggestion">blot</div>
          <div class="suggestion">boot</div>
          <div class="suggestion">bot</div>
          <div class="suggestion">brat</div>
          <div class="suggestion">bro</div>
          <div class="suggestion">bros</div>
          <div class="suggestion">Bret</div>
          <div class="suggestion">Brit</div>
          <div class="suggestion">brut</div>
        </div>
      </div>
    </p>
    <p>
      <button class="previous-button">Previous</button>
      <button class="next-button">Next</button>
    </p>
    <!-- <textarea id="two" rows="20" cols="30">It was a dark and stormy night... Haben sie zeit für brot?</textarea> -->
</body>
</html>

<script>
const carousel = document.querySelector('.suggestions')
const cells = carousel.querySelectorAll('.suggestion')
const cellHeight = carousel.offsetHeight
const cellCount = cells.length
let radius, theta, selectedIndex = 0

function rotateCarousel() {
  const angle = theta * selectedIndex * -1
  let current = Math.abs(selectedIndex % cellCount)

  if (selectedIndex < 0 && current !== 0) {
    current = cellCount - current
  }

  for (let i = 0; i < cellCount; i++) {
    const next = current + 1 === cellCount ? 0 : current + 1
    let opacity = null
    switch (i) {
      case current:
        opacity = 1
        break
      case next:
        opacity = cellCount > 2 ? 0.3 : 0
        break
      default:
        opacity = 0.3
    }
    carousel.children[i].style.opacity = opacity
  }

  carousel.style.transform = `translateZ(${-radius}px) rotateX(${angle}deg)`
}

const prevButton = document.querySelector('.previous-button')
prevButton.addEventListener( 'click', () => {
  selectedIndex--
  rotateCarousel()
})

const nextButton = document.querySelector('.next-button')
nextButton.addEventListener( 'click', () => {
  selectedIndex++
  rotateCarousel()
})

function changeCarousel() {
  theta = 360 / cellCount
  radius = Math.round((cellHeight / 2) / Math.tan(Math.PI / cellCount))
  radius = Math.sign(radius) < 1 ? 0 : radius
  for (let i = 0; i < cells.length; i++ ) {
    const cell = cells[i]
    const cellAngle = theta * i
    cell.style.transform = `rotateX(${cellAngle}deg) translateZ(${radius}px)`
  }

  rotateCarousel()
}

changeCarousel()
</script>
